<div class="container-fluid">

  <mat-card>
    <mat-form-field appearance="fill">
      <mat-label>Selecciona una maquina</mat-label>
      <mat-select [(value)]="seleccion" (selectionChange)="getRepuestosByMaquina(seleccion)">
        <mat-option value="all">Todos</mat-option>
        <mat-option *ngFor="let maquina of dataSourceMaquinas" value="{{maquina.id}}">
          {{maquina.maquina_cod}}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <!-- <p>Seleccionaste la maquina: <b>{{seleccion}}</b></p> -->


   




    <div class="container-fluid">

      <mat-card>
        <div>
          <div *ngIf="seleccion == 'all'">
            Cantidad total de repuestos asociados: {{cantidadTotal}}
          </div> 
          <div *ngIf="seleccion != 'all'">
            Cantidad de repuestos asociados a la maquina: {{cantidad}} 
            <div *ngIf="cantidad == 0">
              <p style="color: #D58E00;">La maquina seleccionada no tiene repuestos asociados.</p>
            </div>
          </div>
        </div>
      </mat-card>
      

      

      <table mat-table [dataSource]="changeDataSource()" class="table mat-elevation-z8">
      

        <ng-container matColumnDef="nombre">
          <th mat-header-cell *matHeaderCellDef> Nombre de repuesto </th>
          <td mat-cell *matCellDef="let repuesto"> {{repuesto.nombre}} </td>
        </ng-container>

        
        <ng-container matColumnDef="modelo">
          <th mat-header-cell *matHeaderCellDef> Modelo de repuesto </th>
          <td mat-cell *matCellDef="let repuesto"> {{repuesto.modelo}} </td>
        </ng-container>


        <ng-container matColumnDef="cantidadInstalada">
          <th mat-header-cell *matHeaderCellDef> Cantidad instalada </th>
          <td mat-cell *matCellDef="let repuesto"> {{repuesto.cantidadInstalada}} </td>
        </ng-container>

        
        <ng-container matColumnDef="maquina.maquina_cod">
          <th mat-header-cell *matHeaderCellDef> Asociado a maquina  </th>
          <td mat-cell *matCellDef="let repuesto">
            <div *ngIf="repuesto.maquina != null">
              <b>{{repuesto.maquina.maquina_cod}}</b> 
            </div>
            <div *ngIf="repuesto.maquina == null">
              <p style="color: #D58E00;"><b>-</b></p> 
            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="maquina.planta.nombre">
          <th mat-header-cell *matHeaderCellDef> Planta </th>
          <td mat-cell *matCellDef="let repuesto">
            <div *ngIf="repuesto.maquina != null">
              {{repuesto.maquina.planta.nombre}} 
            </div>
            <div *ngIf="repuesto.maquina == null">
              <p style="color: #D58E00;"><b>-</b></p> 
            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="maquina.sector.descripcion">
          <th mat-header-cell *matHeaderCellDef> Sector </th>
          <td mat-cell *matCellDef="let repuesto">
            <div *ngIf="repuesto.maquina != null">
              {{repuesto.maquina.sector.descripcion}} 
            </div>
            <div *ngIf="repuesto.maquina == null">
              <p style="color: #D58E00;"><b>-</b></p> 
            </div> 
          </td>
        </ng-container>
      

       


        


        <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
        <tr mat-row *matRowDef="let row; columns: columnsToDisplay;"></tr>

      </table>
    </div>

    <app-button [routerLink]="['lista-repuestos']" [name]="['Nueva asociaciÃ³n']"></app-button>


  </mat-card>

</div>